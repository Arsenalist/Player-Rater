/*! player-rater 24-12-2013 */
var addLoadEvent,displayGrade,displayGrades,gradeSelectCallback,initGradeDisplay,populateSelectBox,showSelectBox,updateGrade,windowLoadHandler,__indexOf=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};addLoadEvent=function(a){var b;return b=window.onload,window.onload="function"!=typeof window.onload?a:function(){return b(),a()}},initGradeDisplay=function(){var a,b;return a=document.getElementById("grader-iframe"),b={type:"populate-grades",data:{game_id:a.getAttribute("data-game-id"),team_id:a.getAttribute("data-team-id")}},a.contentWindow.postMessage(JSON.stringify(b),"*")},gradeSelectCallback=function(a){var b,c;return b=document.getElementById("grader-iframe"),c={type:"record-grade",data:{game_id:b.getAttribute("data-game-id"),team_id:b.getAttribute("data-team-id"),player_id:a.target.previousSibling.previousSibling.getAttribute("data-player-id"),player_grade:a.target.value}},a.target.style.display="none",b.contentWindow.postMessage(JSON.stringify(c),"*")},showSelectBox=function(a){return document.getElementById("user-grade-container-"+a).nextSibling.style.display="",!1},displayGrades=function(a){var b,c,d,e,f,g,h,i,j,k,l,m;for(populateSelectBox(),f=a.data.grades,h=[],i=0,k=f.length;k>i;i++)b=f[i],null!=b.player_id&&(displayGrade(b,!b.voted),h.push(b.player_id));for(e=document.getElementsByClassName("grade-holder"),m=[],j=0,l=e.length;l>j;j++)c=e[j],g=c.getAttribute("data-player-id"),null!=g&&__indexOf.call(h,g)<0?(d={player_id:g,grade:"-",count:0},m.push(displayGrade(d,!0))):m.push(void 0);return m},displayGrade=function(a,b){var c,d;return d=document.getElementById("user-grade-container-"+a.player_id),c="		<div style=\"margin-top: 3px; padding: 4px; text-align:center; background: #cc0000; color: white; font-weight: bold\" class='user-grade'>"+a.grade+"</div>		<div style=\"padding: 4px; text-align: center; color: white; background: black; font-weight: bold; font-size: .8em\" class='user-grade-count'>"+a.count+"</div>",d.innerHTML=c,d.nextSibling.style.display=b?"":"none"},updateGrade=function(a){return displayGrade(a.data,!1)},populateSelectBox=function(){var a,b,c,d,e,f,g,h,i,j;for(b=document.getElementsByClassName("grade-holder"),c=["Rate!","A+","A-","A","B+","B","B-","C+","C","C-","D+","D","D-","F"],e="",f=0,h=c.length;h>f;f++)a=c[f],e+="<option>"+a+"</option>";for(j=[],g=0,i=b.length;i>g;g++)a=b[g],d=document.createElement("select"),d.innerHTML=e,d.onchange=gradeSelectCallback,d.setAttribute("style","font-size: .6em"),d.style.display="",j.push(a.appendChild(d));return j},windowLoadHandler=function(a){var b;switch(b=JSON.parse(a.data),b.type){case"updated-grade":return updateGrade(b);case"display-grades":return displayGrades(b)}},addLoadEvent(function(){return window.addEventListener("message",windowLoadHandler,!1),initGradeDisplay()});